require("dotenv").config({debug:process.env.DEBUG});const getTokenMailTemplate=require("./templates").getTokenMailTemplate,getConfMailTemplate=require("./templates").getConfMailTemplate,mailgun=require("mailgun-js"),mailgunDomain=process.env.MAILGUN_DOMAIN,mailgunApiKey=process.env.MAILGUN_APIKEY,mailgunHost=process.env.MAILGUN_HOST,mg=mailgun({apiKey:mailgunApiKey,domain:mailgunDomain,host:mailgunHost});function sendTokenEmail(e,n,s,a,o){const i=getTokenMailTemplate(n,a.headers.host,e);mg.messages().send(i,function(e,i){if(e)return e.shouldRedirect=!0,e.statusCode=500,e.messageForConsole="Sending token email failed.",o(e);a.flash("success",`An email has been sent to ${n.email} with further instructions.`),s(e,"All Done")})}function sendConfEmail(e,n,s,a){const o=getConfMailTemplate(e);mg.messages().send(o,function(e,o){e&&(e.shouldRedirect=!0,e.statusCode=500,e.messageForConsole="Sending confirmation email failed.",a(e)),s.flash("success","Your password has been changed successfully!"),n(e,"All Done")})}module.exports={sendTokenEmail:sendTokenEmail,sendConfEmail:sendConfEmail};